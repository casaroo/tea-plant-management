<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èŒ¶æ ‘ç”Ÿé•¿æ¨¡å‹åˆ†æ - èŒ¶æ ‘ç®¡ç†ç³»ç»Ÿ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="{{ url_for('static', filename='tea-plant-selector.js') }}"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .feature-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        .prediction-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        .operation-card {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }
        .model-controls {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .model-viewer {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
        }
        .environment-indicator {
            position: absolute;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            color: white;
            font-weight: bold;
            z-index: 1000;
        }
        .temperature-indicator { background: rgba(255, 99, 132, 0.8); }
        .humidity-indicator { background: rgba(54, 162, 235, 0.8); }
        .soil-indicator { background: rgba(255, 206, 86, 0.8); }
        .nutrient-indicator { background: rgba(75, 192, 192, 0.8); }
    </style>
</head>
<body class="bg-gray-50">
    <!-- å¯¼èˆªæ  -->
    <nav class="gradient-bg text-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-4">
                    <h1 class="text-2xl font-bold">ğŸƒ èŒ¶æ ‘ç®¡ç†ç³»ç»Ÿ</h1>
                    <span class="text-lg">| ç”Ÿé•¿æ¨¡å‹åˆ†æ</span>
                </div>
                <div class="flex space-x-4">
                    <a href="/" class="hover:text-green-200 transition-colors">é¦–é¡µ</a>
                    <a href="/tea-plants" class="hover:text-green-200 transition-colors">èŒ¶æ ‘ç®¡ç†</a>
                    <a href="/growth-model" class="hover:text-green-200 transition-colors">ç”Ÿé•¿æ¨¡å‹</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- ä¸»è¦å†…å®¹ -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- èŒ¶æ ‘é€‰æ‹©å™¨ -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div>
                    <h3 class="text-lg font-semibold text-gray-800">é€‰æ‹©èŒ¶æ ‘è¿›è¡Œåˆ†æ</h3>
                    <p class="text-gray-500 text-sm">é€‰æ‹©ä»»æ„å·²è®°å½•çš„èŒ¶æ ‘è¿›è¡Œè¯¦ç»†ç”Ÿé•¿åˆ†æå’Œ3Då¯è§†åŒ–</p>
                </div>
                <div class="flex flex-wrap gap-3">
                    <select id="areaSelector" class="border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                        <option value="all">æ‰€æœ‰åŒºåŸŸ</option>
                        <option value="A">AåŒº</option>
                        <option value="B">BåŒº</option>
                        <option value="C">CåŒº</option>
                        <option value="D">DåŒº</option>
                    </select>
                    <select id="plantSelector" class="border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                        <option value="">é€‰æ‹©èŒ¶æ ‘...</option>
                    </select>
                    <button id="refreshBtn" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors duration-300">
                        <i class="fa fa-refresh mr-1"></i> æ›´æ–°æ•°æ®
                    </button>
                </div>
            </div>
        </div>

        <!-- èŒ¶æ ‘ä¿¡æ¯å¤´éƒ¨ -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <div class="flex items-center justify-between">
                <div>
                    <h2 class="text-3xl font-bold text-gray-800 mb-2" id="plantName">èŒ¶æ ‘ #<span id="plantId"></span></h2>
                    <p class="text-gray-600" id="plantInfo">æ­£åœ¨åŠ è½½èŒ¶æ ‘ä¿¡æ¯...</p>
                </div>
                <div class="text-right">
                    <div class="text-2xl font-bold text-green-600" id="healthScore">--</div>
                    <div class="text-sm text-gray-500">å¥åº·è¯„åˆ†</div>
                </div>
            </div>
        </div>

        <!-- 3DèŒ¶æ ‘æ¨¡å‹å¯è§†åŒ– -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <div class="flex flex-col lg:flex-row gap-6">
                <!-- 3Dæ¨¡å‹æ˜¾ç¤ºåŒºåŸŸ -->
                <div class="flex-1 relative">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        ğŸŒ³ èŒ¶æ ‘3Dç”Ÿé•¿æ¨¡å‹
                    </h3>
                    <div id="3dModelContainer" class="model-viewer rounded-lg p-4 min-h-96 flex items-center justify-center relative">
                        <div class="text-center text-white">
                            <i class="fa fa-tree text-4xl mb-2"></i>
                            <p>è¯·é€‰æ‹©èŒ¶æ ‘ä»¥æ˜¾ç¤º3Dæ¨¡å‹</p>
                        </div>
                    </div>
                    
                    <!-- ç¯å¢ƒæ•°æ®æŒ‡ç¤ºå™¨ -->
                    <div id="environmentIndicators" class="hidden">
                        <div class="environment-indicator temperature-indicator" style="top: 20px; left: 20px;">
                            æ¸©åº¦: <span id="tempValue">--</span>Â°C
                        </div>
                        <div class="environment-indicator humidity-indicator" style="top: 20px; right: 20px;">
                            æ¹¿åº¦: <span id="humidityValue">--</span>%
                        </div>
                        <div class="environment-indicator soil-indicator" style="bottom: 20px; left: 20px;">
                            åœŸå£¤: <span id="soilValue">--</span>%
                        </div>
                        <div class="environment-indicator nutrient-indicator" style="bottom: 20px; right: 20px;">
                            è¥å…»: <span id="nutrientValue">--</span>
                        </div>
                    </div>
                </div>
                
                <!-- 3Dæ¨¡å‹æ§åˆ¶é¢æ¿ -->
                <div class="lg:w-80">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4">æ¨¡å‹æ§åˆ¶</h4>
                    
                    <!-- è§†è§’æ§åˆ¶ -->
                    <div class="bg-gray-50 rounded-lg p-4 mb-4">
                        <h5 class="font-medium text-gray-700 mb-3">è§†è§’æ§åˆ¶</h5>
                        <div class="grid grid-cols-2 gap-2">
                            <button id="viewFront" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded text-sm">
                                æ­£é¢è§†å›¾
                            </button>
                            <button id="viewSide" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded text-sm">
                                ä¾§é¢è§†å›¾
                            </button>
                            <button id="viewTop" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded text-sm">
                                ä¿¯è§†å›¾
                            </button>
                            <button id="view3D" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded text-sm">
                                3Dè§†å›¾
                            </button>
                        </div>
                    </div>
                    
                    <!-- æ¨¡å‹ç»„ä»¶æ§åˆ¶ -->
                    <div class="bg-gray-50 rounded-lg p-4 mb-4">
                        <h5 class="font-medium text-gray-700 mb-3">æ˜¾ç¤ºç»„ä»¶</h5>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="checkbox" id="showTrunk" checked class="mr-2">
                                <span class="text-sm">æ ‘å¹²</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="showCrown" checked class="mr-2">
                                <span class="text-sm">æ ‘å† </span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="showLeaves" checked class="mr-2">
                                <span class="text-sm">å¶ç‰‡</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="showRoots" checked class="mr-2">
                                <span class="text-sm">æ ¹ç³»</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="showEnvironment" checked class="mr-2">
                                <span class="text-sm">ç¯å¢ƒæ•°æ®</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- ç”Ÿé•¿åŠ¨ç”»æ§åˆ¶ -->
                    <div class="bg-gray-50 rounded-lg p-4 mb-4">
                        <h5 class="font-medium text-gray-700 mb-3">ç”Ÿé•¿åŠ¨ç”»</h5>
                        <div class="space-y-3">
                            <div>
                                <label class="text-sm text-gray-600">åŠ¨ç”»è¿›åº¦</label>
                                <input type="range" id="growthSlider" min="0" max="100" value="0" class="w-full">
                                <div class="text-xs text-gray-500 text-center" id="growthProgress">0%</div>
                            </div>
                            <div class="flex gap-2">
                                <button id="playAnimation" class="bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded text-sm flex-1">
                                    <i class="fa fa-play mr-1"></i> æ’­æ”¾
                                </button>
                                <button id="pauseAnimation" class="bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-2 rounded text-sm flex-1">
                                    <i class="fa fa-pause mr-1"></i> æš‚åœ
                                </button>
                                <button id="resetAnimation" class="bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded text-sm flex-1">
                                    <i class="fa fa-refresh mr-1"></i> é‡ç½®
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- æ¨¡å‹ä¿¡æ¯ -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h5 class="font-medium text-gray-700 mb-3">æ¨¡å‹ä¿¡æ¯</h5>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-600">æ ‘é«˜:</span>
                                <span id="modelHeight" class="font-medium">--</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">å† å¹…:</span>
                                <span id="modelWidth" class="font-medium">--</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">å¶ç‰‡æ•°:</span>
                                <span id="modelLeafCount" class="font-medium">--</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">ç”Ÿé•¿é˜¶æ®µ:</span>
                                <span id="modelStage" class="font-medium">--</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- åˆ†æå†…å®¹ç½‘æ ¼ -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- ç”Ÿé•¿æ›²çº¿å¯¹æ¯”åˆ†æ -->
            <div class="bg-white rounded-lg shadow-lg p-6 card-hover">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    ğŸ“ˆ ç”Ÿé•¿æ›²çº¿å¯¹æ¯”åˆ†æ
                </h3>
                <div class="h-80">
                    <canvas id="growthChart"></canvas>
                </div>
            </div>

            <!-- ç¯å¢ƒå› ç´ å½±å“åˆ†æ -->
            <div class="bg-white rounded-lg shadow-lg p-6 card-hover">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    ğŸŒ¡ï¸ ç¯å¢ƒå› ç´ å½±å“åˆ†æ
                </h3>
                <div class="h-80">
                    <canvas id="environmentChart"></canvas>
                </div>
            </div>

            <!-- ç”Ÿç‰©ç‰¹å¾åˆ†æ -->
            <div class="bg-white rounded-lg shadow-lg p-6 card-hover">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    ğŸ§¬ ç”Ÿç‰©ç‰¹å¾åˆ†æ
                </h3>
                <div class="h-80">
                    <canvas id="biologicalChart"></canvas>
                </div>
            </div>

            <!-- ç”Ÿé•¿é¢„æµ‹åˆ†æ -->
            <div class="bg-white rounded-lg shadow-lg p-6 card-hover">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    ğŸ”® ç”Ÿé•¿é¢„æµ‹åˆ†æ
                </h3>
                <div class="h-80">
                    <canvas id="predictionChart"></canvas>
                </div>
            </div>
        </div>

        <!-- å†œäº‹æ“ä½œå»ºè®® -->
        <div class="bg-white rounded-lg shadow-lg p-6 mt-8">
            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                ğŸšœ å†œäº‹æ“ä½œå»ºè®®
            </h3>
            <div id="agriculturalOperations" class="space-y-4">
                <div class="text-center text-gray-500 py-8">
                    <i class="fa fa-leaf text-4xl mb-2"></i>
                    <p>è¯·é€‰æ‹©èŒ¶æ ‘ä»¥æŸ¥çœ‹å†œäº‹æ“ä½œå»ºè®®</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let teaPlantSelector = null;
        let current3DModel = null;
        let animationInterval = null;
        let currentAnimationFrame = 0;

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹åˆå§‹åŒ–èŒ¶æ ‘é€‰æ‹©å™¨...');
            initTeaPlantSelector();
        });

        // èŒ¶æ ‘é€‰æ‹©å™¨åˆå§‹åŒ–
        function initTeaPlantSelector() {
            try {
                teaPlantSelector = new TeaPlantSelector({
                    onPlantChange: function(plantId) {
                        console.log('èŒ¶æ ‘é€‰æ‹©å˜åŒ–:', plantId);
                        if (plantId) {
                            loadPlantAnalysis(plantId);
                            load3DModel(plantId);
                        } else {
                            clearPlantAnalysis();
                            clear3DModel();
                        }
                    },
                    onRefresh: function() {
                        console.log('åˆ·æ–°èŒ¶æ ‘æ•°æ®...');
                        if (teaPlantSelector && teaPlantSelector.currentPlantId) {
                            loadPlantAnalysis(teaPlantSelector.currentPlantId);
                            load3DModel(teaPlantSelector.currentPlantId);
                        } else {
                            // å¦‚æœæ²¡æœ‰é€‰ä¸­çš„èŒ¶æ ‘ï¼Œé‡æ–°åŠ è½½èŒ¶æ ‘åˆ—è¡¨
                            teaPlantSelector.refreshTeaPlants();
                        }
                    }
                });
                
                console.log('èŒ¶æ ‘é€‰æ‹©å™¨åˆå§‹åŒ–æˆåŠŸ');
            } catch (error) {
                console.error('èŒ¶æ ‘é€‰æ‹©å™¨åˆå§‹åŒ–å¤±è´¥:', error);
                // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                showErrorMessage('èŒ¶æ ‘é€‰æ‹©å™¨åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
            }
        }

        // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
        function showErrorMessage(message) {
            const container = document.getElementById('3dModelContainer');
            if (container) {
                container.innerHTML = `
                    <div class="text-center text-white">
                        <i class="fa fa-exclamation-triangle text-4xl mb-2 text-red-400"></i>
                        <p class="text-red-400">${message}</p>
                    </div>
                `;
            }
        }

        // åŠ è½½èŒ¶æ ‘åˆ†ææ•°æ®
        async function loadPlantAnalysis(plantId) {
            try {
                console.log('å¼€å§‹åŠ è½½èŒ¶æ ‘åˆ†ææ•°æ®:', plantId);
                
                // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                document.getElementById('plantId').textContent = 'åŠ è½½ä¸­...';
                document.getElementById('plantName').textContent = 'èŒ¶æ ‘ #åŠ è½½ä¸­...';
                document.getElementById('plantInfo').textContent = 'æ­£åœ¨åŠ è½½èŒ¶æ ‘ä¿¡æ¯...';
                
                // åŠ è½½åŸºæœ¬ä¿¡æ¯
                const plantResponse = await fetch(`/api/tea-plants/${plantId}`);
                if (!plantResponse.ok) {
                    throw new Error(`HTTP error! status: ${plantResponse.status}`);
                }
                
                const plantData = await plantResponse.json();
                
                if (plantData.error) {
                    console.error('åŠ è½½èŒ¶æ ‘ä¿¡æ¯å¤±è´¥:', plantData.error);
                    showErrorMessage(`åŠ è½½èŒ¶æ ‘ä¿¡æ¯å¤±è´¥: ${plantData.error}`);
                    return;
                }
                
                console.log('èŒ¶æ ‘åŸºæœ¬ä¿¡æ¯åŠ è½½æˆåŠŸ:', plantData);
                
                // æ›´æ–°èŒ¶æ ‘ä¿¡æ¯
                document.getElementById('plantId').textContent = plantData.plant.id;
                document.getElementById('plantName').textContent = `èŒ¶æ ‘ #${plantData.plant.id} - ${plantData.plant.variety}`;
                
                const location = plantData.plant.location_area && plantData.plant.location_row 
                    ? `${plantData.plant.location_area}åŒº${plantData.plant.location_row}` 
                    : (plantData.plant.location || 'æœªçŸ¥ä½ç½®');
                document.getElementById('plantInfo').textContent = 
                    `${location} | ${plantData.plant.current_stage} | æ ‘é«˜: ${plantData.plant.height}m | å† å¹…: ${plantData.plant.crown_width}m`;
                
                // åŠ è½½ç”Ÿé•¿åˆ†ææ•°æ®
                await loadGrowthAnalysis(plantId);
                
                // åŠ è½½å†œäº‹æ“ä½œå»ºè®®
                await loadAgriculturalOperations(plantId);
                
            } catch (error) {
                console.error('åŠ è½½èŒ¶æ ‘åˆ†æå¤±è´¥:', error);
                showErrorMessage(`åŠ è½½èŒ¶æ ‘åˆ†æå¤±è´¥: ${error.message}`);
            }
        }

        // æ¸…é™¤èŒ¶æ ‘åˆ†ææ•°æ®
        function clearPlantAnalysis() {
            document.getElementById('plantId').textContent = '';
            document.getElementById('plantName').textContent = 'èŒ¶æ ‘ #--';
            document.getElementById('plantInfo').textContent = 'è¯·é€‰æ‹©èŒ¶æ ‘è¿›è¡Œåˆ†æ';
            
            // æ¸…é™¤å…¶ä»–ç›¸å…³æ•°æ®
            clearGrowthAnalysis();
            clearAgriculturalOperations();
        }

        // æ¸…é™¤ç”Ÿé•¿åˆ†ææ•°æ®
        function clearGrowthAnalysis() {
            // æ¸…é™¤ç”Ÿé•¿åˆ†æç›¸å…³çš„å›¾è¡¨å’Œæ•°æ®
            const containers = ['growthAnalysis', 'biologicalFeatures', 'growthPrediction'];
            containers.forEach(id => {
                const container = document.getElementById(id);
                if (container) {
                    container.innerHTML = `
                        <div class="text-center text-gray-500 py-8">
                            <i class="fa fa-chart-line text-4xl mb-2"></i>
                            <p>è¯·é€‰æ‹©èŒ¶æ ‘ä»¥æŸ¥çœ‹ç”Ÿé•¿åˆ†æ</p>
                        </div>
                    `;
                }
            });
        }

        // æ¸…é™¤å†œäº‹æ“ä½œæ•°æ®
        function clearAgriculturalOperations() {
            const container = document.getElementById('agriculturalOperations');
            if (container) {
                container.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <i class="fa fa-leaf text-4xl mb-2"></i>
                        <p>è¯·é€‰æ‹©èŒ¶æ ‘ä»¥æŸ¥çœ‹å†œäº‹æ“ä½œå»ºè®®</p>
                    </div>
                `;
            }
        }

        // 3Dæ¨¡å‹ç›¸å…³åŠŸèƒ½
        async function load3DModel(plantId) {
            try {
                console.log('å¼€å§‹åŠ è½½3Dæ¨¡å‹:', plantId);
                
                // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                const container = document.getElementById('3dModelContainer');
                container.innerHTML = `
                    <div class="text-center text-white">
                        <i class="fa fa-spinner fa-spin text-4xl mb-2"></i>
                        <p>æ­£åœ¨åŠ è½½3Dæ¨¡å‹...</p>
                    </div>
                `;
                
                const response = await fetch(`/api/tea-plants/${plantId}/3d-model`);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.error) {
                    console.error('åŠ è½½3Dæ¨¡å‹å¤±è´¥:', data.error);
                    showErrorMessage(`åŠ è½½3Dæ¨¡å‹å¤±è´¥: ${data.error}`);
                    return;
                }
                
                console.log('3Dæ¨¡å‹æ•°æ®åŠ è½½æˆåŠŸ:', data);
                
                current3DModel = data;
                render3DModel(data);
                updateModelInfo(data);
                setupModelControls();
                updateEnvironmentIndicators(data);
                
            } catch (error) {
                console.error('åŠ è½½3Dæ¨¡å‹å¤±è´¥:', error);
                showErrorMessage(`åŠ è½½3Dæ¨¡å‹å¤±è´¥: ${error.message}`);
            }
        }

        // æ¸…é™¤3Dæ¨¡å‹
        function clear3DModel() {
            const container = document.getElementById('3dModelContainer');
            container.innerHTML = `
                <div class="text-center text-white">
                    <i class="fa fa-tree text-4xl mb-2"></i>
                    <p>è¯·é€‰æ‹©èŒ¶æ ‘ä»¥æ˜¾ç¤º3Dæ¨¡å‹</p>
                </div>
            `;
            
            current3DModel = null;
            if (animationInterval) {
                clearInterval(animationInterval);
                animationInterval = null;
            }
            
            // éšè—ç¯å¢ƒæŒ‡ç¤ºå™¨
            document.getElementById('environmentIndicators').classList.add('hidden');
        }

        // åŠ è½½ç”Ÿé•¿åˆ†ææ•°æ®
        async function loadGrowthAnalysis(plantId) {
            try {
                console.log('å¼€å§‹åŠ è½½ç”Ÿé•¿åˆ†ææ•°æ®:', plantId);
                
                // è¿™é‡Œå¯ä»¥æ·»åŠ åŠ è½½ç”Ÿé•¿åˆ†ææ•°æ®çš„é€»è¾‘
                // ä¾‹å¦‚ï¼šåŠ è½½ç”Ÿé•¿æ›²çº¿ã€ç”Ÿç‰©ç‰¹å¾ç­‰
                
            } catch (error) {
                console.error('åŠ è½½ç”Ÿé•¿åˆ†æå¤±è´¥:', error);
            }
        }

        // åŠ è½½å†œäº‹æ“ä½œå»ºè®®
        async function loadAgriculturalOperations(plantId) {
            try {
                console.log('å¼€å§‹åŠ è½½å†œäº‹æ“ä½œå»ºè®®:', plantId);
                
                // è¿™é‡Œå¯ä»¥æ·»åŠ åŠ è½½å†œäº‹æ“ä½œå»ºè®®çš„é€»è¾‘
                
            } catch (error) {
                console.error('åŠ è½½å†œäº‹æ“ä½œå»ºè®®å¤±è´¥:', error);
            }
        }

        // æ¸²æŸ“3Dæ¨¡å‹ - ä½¿ç”¨æ›´çœŸå®çš„èŒ¶æ ‘å‡ ä½•å½¢çŠ¶
        function render3DModel(data) {
            const container = document.getElementById('3dModelContainer');
            
            // ç”Ÿæˆæ›´çœŸå®çš„èŒ¶æ ‘3Dæ¨¡å‹æ•°æ®
            const traces = [];
            
            // æ ‘å¹² - ä½¿ç”¨åœ†æŸ±ä½“å½¢çŠ¶
            if (data.model_data.trunk.points.length > 0) {
                const trunkTrace = {
                    x: data.model_data.trunk.points.map(p => p[0]),
                    y: data.model_data.trunk.points.map(p => p[1]),
                    z: data.model_data.trunk.points.map(p => p[2]),
                    mode: 'markers',
                    type: 'scatter3d',
                    name: 'æ ‘å¹²',
                    marker: {
                        size: 4,
                        color: '#8B4513',
                        opacity: 0.9,
                        symbol: 'circle'
                    }
                };
                traces.push(trunkTrace);
            }
            
            // æ ‘å†  - ä½¿ç”¨æ¤­åœ†å½¢åˆ†å±‚ç»“æ„
            if (data.model_data.crown.points.length > 0) {
                const crownTrace = {
                    x: data.model_data.crown.points.map(p => p[0]),
                    y: data.model_data.crown.points.map(p => p[1]),
                    z: data.model_data.crown.points.map(p => p[2]),
                    mode: 'markers',
                    type: 'scatter3d',
                    name: 'æ ‘å† ',
                    marker: {
                        size: 5,
                        color: '#228B22',
                        opacity: 0.8,
                        symbol: 'circle'
                    }
                };
                traces.push(crownTrace);
            }
            
            // å¶ç‰‡ - ä½¿ç”¨å¹³é¢å½¢çŠ¶
            if (data.model_data.leaves.points.length > 0) {
                const leafTrace = {
                    x: data.model_data.leaves.points.map(p => p[0]),
                    y: data.model_data.leaves.points.map(p => p[1]),
                    z: data.model_data.leaves.points.map(p => p[2]),
                    mode: 'markers',
                    type: 'scatter3d',
                    name: 'å¶ç‰‡',
                    marker: {
                        size: 3,
                        color: '#32CD32',
                        opacity: 0.7,
                        symbol: 'diamond'
                    }
                };
                traces.push(leafTrace);
            }
            
            // æ ¹ç³» - ä½¿ç”¨åˆ†æ”¯ç»“æ„
            if (data.model_data.roots.points.length > 0) {
                const rootTrace = {
                    x: data.model_data.roots.points.map(p => p[0]),
                    y: data.model_data.roots.points.map(p => p[1]),
                    z: data.model_data.roots.points.map(p => p[2]),
                    mode: 'markers',
                    type: 'scatter3d',
                    name: 'æ ¹ç³»',
                    marker: {
                        size: 4,
                        color: '#654321',
                        opacity: 0.8,
                        symbol: 'circle'
                    }
                };
                traces.push(rootTrace);
            }
            
            // æ·»åŠ ç¯å¢ƒæ•°æ®å¯è§†åŒ–ç‚¹
            if (data.environmental_data && data.environmental_data.length > 0) {
                const envTrace = {
                    x: data.environmental_data.map((_, i) => Math.cos(i * 0.5) * 0.5),
                    y: data.environmental_data.map((_, i) => Math.sin(i * 0.5) * 0.5),
                    z: data.environmental_data.map((_, i) => 0.1),
                    mode: 'markers',
                    type: 'scatter3d',
                    name: 'ç¯å¢ƒç›‘æµ‹ç‚¹',
                    marker: {
                        size: 6,
                        color: data.environmental_data.map(env => {
                            // æ ¹æ®æ¸©åº¦ç€è‰²
                            if (env.temperature > 25) return '#FF6B6B'; // é«˜æ¸©çº¢è‰²
                            if (env.temperature < 15) return '#4ECDC4'; // ä½æ¸©è“è‰²
                            return '#45B7D1'; // é€‚å®œæ¸©åº¦è“è‰²
                        }),
                        opacity: 0.6,
                        symbol: 'star'
                    }
                };
                traces.push(envTrace);
            }
            
            const layout = {
                scene: {
                    xaxis: { 
                        title: 'Xè½´ (m)', 
                        range: [-2, 2],
                        gridcolor: '#444',
                        zerolinecolor: '#666'
                    },
                    yaxis: { 
                        title: 'Yè½´ (m)', 
                        range: [-2, 2],
                        gridcolor: '#444',
                        zerolinecolor: '#666'
                    },
                    zaxis: { 
                        title: 'Zè½´ (m)', 
                        range: [-1, 3],
                        gridcolor: '#444',
                        zerolinecolor: '#666'
                    },
                    camera: {
                        eye: { x: 1.5, y: 1.5, z: 1.5 }
                    },
                    bgcolor: '#2c3e50'
                },
                margin: { l: 0, r: 0, b: 0, t: 0 },
                showlegend: true,
                legend: { 
                    x: 0.1, 
                    y: 0.9,
                    bgcolor: 'rgba(255,255,255,0.8)',
                    bordercolor: '#ccc'
                },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)'
            };
            
            Plotly.newPlot('3dModelContainer', traces, layout, {
                responsive: true,
                displayModeBar: true,
                displaylogo: false,
                modeBarButtonsToRemove: ['pan2d', 'lasso2d', 'select2d']
            });
        }

        // æ›´æ–°ç¯å¢ƒæ•°æ®æŒ‡ç¤ºå™¨
        function updateEnvironmentIndicators(data) {
            if (data.environmental_data && data.environmental_data.length > 0) {
                const latestEnv = data.environmental_data[0];
                
                document.getElementById('tempValue').textContent = latestEnv.temperature?.toFixed(1) || '--';
                document.getElementById('humidityValue').textContent = latestEnv.humidity?.toFixed(1) || '--';
                document.getElementById('soilValue').textContent = latestEnv.soil_moisture?.toFixed(1) || '--';
                
                // è®¡ç®—è¥å…»æŒ‡æ•°
                const nutrientIndex = ((latestEnv.nitrogen || 0) + (latestEnv.phosphorus || 0) + (latestEnv.potassium || 0)) / 3;
                document.getElementById('nutrientValue').textContent = nutrientIndex.toFixed(1);
                
                document.getElementById('environmentIndicators').classList.remove('hidden');
            }
        }

        // æ›´æ–°æ¨¡å‹ä¿¡æ¯
        function updateModelInfo(data) {
            document.getElementById('modelHeight').textContent = `${data.tea_plant_info.height}m`;
            document.getElementById('modelWidth').textContent = `${data.tea_plant_info.crown_width}m`;
            document.getElementById('modelLeafCount').textContent = data.tea_plant_info.leaf_count;
            document.getElementById('modelStage').textContent = data.tea_plant_info.current_stage;
        }

        // è®¾ç½®æ¨¡å‹æ§åˆ¶
        function setupModelControls() {
            // è§†è§’æ§åˆ¶
            document.getElementById('viewFront').addEventListener('click', () => {
                Plotly.relayout('3dModelContainer', {
                    'scene.camera.eye': { x: 0, y: -2, z: 0 },
                    'scene.camera.center': { x: 0, y: 0, z: 1 }
                });
            });
            
            document.getElementById('viewSide').addEventListener('click', () => {
                Plotly.relayout('3dModelContainer', {
                    'scene.camera.eye': { x: -2, y: 0, z: 0 },
                    'scene.camera.center': { x: 0, y: 0, z: 1 }
                });
            });
            
            document.getElementById('viewTop').addEventListener('click', () => {
                Plotly.relayout('3dModelContainer', {
                    'scene.camera.eye': { x: 0, y: 0, z: 2 },
                    'scene.camera.center': { x: 0, y: 0, z: 1 }
                });
            });
            
            document.getElementById('view3D').addEventListener('click', () => {
                Plotly.relayout('3dModelContainer', {
                    'scene.camera.eye': { x: 1.5, y: 1.5, z: 1.5 },
                    'scene.camera.center': { x: 0, y: 0, z: 1 }
                });
            });
            
            // ç»„ä»¶æ˜¾ç¤ºæ§åˆ¶
            const componentCheckboxes = ['showTrunk', 'showCrown', 'showLeaves', 'showRoots', 'showEnvironment'];
            componentCheckboxes.forEach(id => {
                document.getElementById(id).addEventListener('change', function() {
                    updateModelVisibility();
                });
            });
            
            // ç”Ÿé•¿åŠ¨ç”»æ§åˆ¶
            const growthSlider = document.getElementById('growthSlider');
            const playBtn = document.getElementById('playAnimation');
            const pauseBtn = document.getElementById('pauseAnimation');
            const resetBtn = document.getElementById('resetAnimation');
            
            growthSlider.addEventListener('input', function() {
                document.getElementById('growthProgress').textContent = this.value + '%';
                updateGrowthAnimation(this.value / 100);
            });
            
            playBtn.addEventListener('click', function() {
                startGrowthAnimation();
            });
            
            pauseBtn.addEventListener('click', function() {
                pauseGrowthAnimation();
            });
            
            resetBtn.addEventListener('click', function() {
                resetGrowthAnimation();
            });
        }

        // æ›´æ–°æ¨¡å‹å¯è§æ€§
        function updateModelVisibility() {
            if (!current3DModel) return;
            
            const showTrunk = document.getElementById('showTrunk').checked;
            const showCrown = document.getElementById('showCrown').checked;
            const showLeaves = document.getElementById('showLeaves').checked;
            const showRoots = document.getElementById('showRoots').checked;
            const showEnvironment = document.getElementById('showEnvironment').checked;
            
            // æ›´æ–°Plotlyå›¾è¡¨çš„å¯è§æ€§
            const updates = [];
            const indices = [];
            
            if (!showTrunk) indices.push(0);
            if (!showCrown) indices.push(1);
            if (!showLeaves) indices.push(2);
            if (!showRoots) indices.push(3);
            if (!showEnvironment && current3DModel.environmental_data) indices.push(4);
            
            if (indices.length > 0) {
                Plotly.restyle('3dModelContainer', { visible: false }, indices);
            }
            
            // æ˜¾ç¤ºé€‰ä¸­çš„ç»„ä»¶
            const visibleIndices = [];
            if (showTrunk) visibleIndices.push(0);
            if (showCrown) visibleIndices.push(1);
            if (showLeaves) visibleIndices.push(2);
            if (showRoots) visibleIndices.push(3);
            if (showEnvironment && current3DModel.environmental_data) visibleIndices.push(4);
            
            if (visibleIndices.length > 0) {
                Plotly.restyle('3dModelContainer', { visible: true }, visibleIndices);
            }
        }

        // å¼€å§‹ç”Ÿé•¿åŠ¨ç”»
        function startGrowthAnimation() {
            if (animationInterval) return;
            
            const slider = document.getElementById('growthSlider');
            let progress = parseInt(slider.value);
            
            animationInterval = setInterval(() => {
                progress += 1;
                if (progress > 100) {
                    progress = 100;
                    clearInterval(animationInterval);
                    animationInterval = null;
                }
                
                slider.value = progress;
                document.getElementById('growthProgress').textContent = progress + '%';
                updateGrowthAnimation(progress / 100);
            }, 50); // æ›´å¿«çš„åŠ¨ç”»é€Ÿåº¦
        }

        // æš‚åœç”Ÿé•¿åŠ¨ç”»
        function pauseGrowthAnimation() {
            if (animationInterval) {
                clearInterval(animationInterval);
                animationInterval = null;
            }
        }

        // é‡ç½®ç”Ÿé•¿åŠ¨ç”»
        function resetGrowthAnimation() {
            pauseGrowthAnimation();
            const slider = document.getElementById('growthSlider');
            slider.value = 0;
            document.getElementById('growthProgress').textContent = '0%';
            updateGrowthAnimation(0);
        }

        // æ›´æ–°ç”Ÿé•¿åŠ¨ç”» - æ›´å¤æ‚çš„åŠ¨ç”»æ•ˆæœ
        function updateGrowthAnimation(progress) {
            if (!current3DModel) return;
            
            // æ ¹æ®è¿›åº¦æ›´æ–°æ¨¡å‹å¤§å°å’Œå½¢çŠ¶
            const heightScale = 0.3 + progress * 0.7;
            const widthScale = 0.2 + progress * 0.8;
            const leafScale = 0.1 + progress * 0.9;
            
            // æ›´æ–°æ ‘å¹²é«˜åº¦
            if (current3DModel.model_data.trunk.points.length > 0) {
                const trunkUpdates = {
                    z: current3DModel.model_data.trunk.points.map(p => p[2] * heightScale)
                };
                Plotly.restyle('3dModelContainer', trunkUpdates, [0]);
            }
            
            // æ›´æ–°æ ‘å† å¤§å°
            if (current3DModel.model_data.crown.points.length > 0) {
                const crownUpdates = {
                    x: current3DModel.model_data.crown.points.map(p => p[0] * widthScale),
                    y: current3DModel.model_data.crown.points.map(p => p[1] * widthScale),
                    z: current3DModel.model_data.crown.points.map(p => p[2] * heightScale)
                };
                Plotly.restyle('3dModelContainer', crownUpdates, [1]);
            }
            
            // æ›´æ–°å¶ç‰‡æ•°é‡å’Œå¤§å°
            if (current3DModel.model_data.leaves.points.length > 0) {
                const leafCount = Math.floor(current3DModel.model_data.leaves.points.length * leafScale);
                const leafUpdates = {
                    x: current3DModel.model_data.leaves.points.slice(0, leafCount).map(p => p[0] * widthScale),
                    y: current3DModel.model_data.leaves.points.slice(0, leafCount).map(p => p[1] * widthScale),
                    z: current3DModel.model_data.leaves.points.slice(0, leafCount).map(p => p[2] * heightScale)
                };
                Plotly.restyle('3dModelContainer', leafUpdates, [2]);
            }
        }

        // åŠ è½½ç”Ÿé•¿åˆ†ææ•°æ®
        async function loadGrowthAnalysis(plantId) {
            try {
                const response = await fetch(`/api/tea-plants/${plantId}/growth-analysis`);
                const data = await response.json();
                
                if (data.error) {
                    console.error('åŠ è½½ç”Ÿé•¿åˆ†æå¤±è´¥:', data.error);
                    return;
                }
                
                // æ›´æ–°å¥åº·è¯„åˆ†
                document.getElementById('healthScore').textContent = data.health_score || '--';
                
                // åˆ›å»ºå›¾è¡¨
                createGrowthChart(data);
                createEnvironmentChart(data);
                createBiologicalChart(data);
                createPredictionChart(data);
                
            } catch (error) {
                console.error('åŠ è½½ç”Ÿé•¿åˆ†æå¤±è´¥:', error);
            }
        }

        // åŠ è½½å†œäº‹æ“ä½œå»ºè®®
        async function loadAgriculturalOperations(plantId) {
            try {
                const response = await fetch(`/api/tea-plants/${plantId}/agricultural-operations`);
                const data = await response.json();
                
                if (data.error) {
                    console.error('åŠ è½½å†œäº‹æ“ä½œå¤±è´¥:', data.error);
                    return;
                }
                
                displayAgriculturalOperations(data.operations);
                
            } catch (error) {
                console.error('åŠ è½½å†œäº‹æ“ä½œå¤±è´¥:', error);
            }
        }

        // æ˜¾ç¤ºå†œäº‹æ“ä½œå»ºè®®
        function displayAgriculturalOperations(operations) {
            const container = document.getElementById('agriculturalOperations');
            
            if (!operations || operations.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <i class="fa fa-check-circle text-4xl mb-2"></i>
                        <p>å½“å‰æ— éœ€ç‰¹æ®Šå†œäº‹æ“ä½œ</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = operations.map(op => `
                <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <div class="flex items-center gap-2 mb-2">
                                <span class="px-2 py-1 rounded-full text-xs font-medium ${
                                    op.priority === 'high' ? 'bg-red-100 text-red-800' :
                                    op.priority === 'medium' ? 'bg-yellow-100 text-yellow-800' :
                                    'bg-green-100 text-green-800'
                                }">${op.priority === 'high' ? 'é«˜ä¼˜å…ˆçº§' : op.priority === 'medium' ? 'ä¸­ä¼˜å…ˆçº§' : 'ä½ä¼˜å…ˆçº§'}</span>
                                <span class="px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">${op.type}</span>
                            </div>
                            <h4 class="font-semibold text-gray-800 mb-2">${op.title}</h4>
                            <p class="text-gray-600 text-sm mb-3">${op.description}</p>
                            <div class="grid grid-cols-2 gap-4 text-sm">
                                <div>
                                    <span class="text-gray-500">æ‰€éœ€ç‰©æ–™:</span>
                                    <span class="font-medium">${op.materials}</span>
                                </div>
                                <div>
                                    <span class="text-gray-500">æ‰§è¡Œæ–¹æ³•:</span>
                                    <span class="font-medium">${op.method}</span>
                                </div>
                                <div>
                                    <span class="text-gray-500">æ‰§è¡Œé¢‘ç‡:</span>
                                    <span class="font-medium">${op.frequency}</span>
                                </div>
                                <div>
                                    <span class="text-gray-500">é¢„è®¡æˆæœ¬:</span>
                                    <span class="font-medium">Â¥${op.estimated_cost}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // æ¸…é™¤å›¾è¡¨
        function clearCharts() {
            const chartIds = ['growthChart', 'environmentChart', 'biologicalChart', 'predictionChart'];
            chartIds.forEach(id => {
                const canvas = document.getElementById(id);
                if (canvas) {
                    const ctx = canvas.getContext('2d');
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                }
            });
        }

        // åˆ›å»ºç”Ÿé•¿æ›²çº¿å›¾è¡¨
        function createGrowthChart(data) {
            const ctx = document.getElementById('growthChart').getContext('2d');
            
            if (window.growthChart) {
                window.growthChart.destroy();
            }
            
            window.growthChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.growth_data?.labels || [],
                    datasets: [{
                        label: 'å®é™…ç”Ÿé•¿',
                        data: data.growth_data?.actual || [],
                        borderColor: 'rgb(59, 130, 246)',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4
                    }, {
                        label: 'é¢„æµ‹ç”Ÿé•¿',
                        data: data.growth_data?.predicted || [],
                        borderColor: 'rgb(239, 68, 68)',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        borderDash: [5, 5],
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'èŒ¶æ ‘ç”Ÿé•¿æ›²çº¿å¯¹æ¯”'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'é«˜åº¦ (m)'
                            }
                        }
                    }
                }
            });
        }

        // åˆ›å»ºç¯å¢ƒå› ç´ å›¾è¡¨
        function createEnvironmentChart(data) {
            const ctx = document.getElementById('environmentChart').getContext('2d');
            
            if (window.environmentChart) {
                window.environmentChart.destroy();
            }
            
            window.environmentChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['æ¸©åº¦', 'æ¹¿åº¦', 'åœŸå£¤æ¹¿åº¦', 'åœŸå£¤pH', 'æ°®å«é‡', 'ç£·å«é‡', 'é’¾å«é‡'],
                    datasets: [{
                        label: 'å½“å‰ç¯å¢ƒ',
                        data: data.environment_data?.current || [],
                        borderColor: 'rgb(59, 130, 246)',
                        backgroundColor: 'rgba(59, 130, 246, 0.2)'
                    }, {
                        label: 'æœ€é€‚ç¯å¢ƒ',
                        data: data.environment_data?.optimal || [],
                        borderColor: 'rgb(239, 68, 68)',
                        backgroundColor: 'rgba(239, 68, 68, 0.2)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ç¯å¢ƒå› ç´ é›·è¾¾å›¾'
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        // åˆ›å»ºç”Ÿç‰©ç‰¹å¾å›¾è¡¨
        function createBiologicalChart(data) {
            const ctx = document.getElementById('biologicalChart').getContext('2d');
            
            if (window.biologicalChart) {
                window.biologicalChart.destroy();
            }
            
            window.biologicalChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.biological_features?.labels || [],
                    datasets: [{
                        label: 'ç‰¹å¾å€¼',
                        data: data.biological_features?.values || [],
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(16, 185, 129, 0.8)',
                            'rgba(245, 158, 11, 0.8)',
                            'rgba(239, 68, 68, 0.8)',
                            'rgba(139, 92, 246, 0.8)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ç”Ÿç‰©ç‰¹å¾åˆ†æ'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // åˆ›å»ºé¢„æµ‹å›¾è¡¨
        function createPredictionChart(data) {
            const ctx = document.getElementById('predictionChart').getContext('2d');
            
            if (window.predictionChart) {
                window.predictionChart.destroy();
            }
            
            window.predictionChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.growth_prediction?.labels || [],
                    datasets: [{
                        label: 'é«˜åº¦é¢„æµ‹',
                        data: data.growth_prediction?.height || [],
                        borderColor: 'rgb(16, 185, 129)',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        yAxisID: 'y'
                    }, {
                        label: 'äº§é‡é¢„æµ‹',
                        data: data.growth_prediction?.yield || [],
                        borderColor: 'rgb(245, 158, 11)',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        yAxisID: 'y1'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ç”Ÿé•¿é¢„æµ‹åˆ†æ'
                        }
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'é«˜åº¦ (m)'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'äº§é‡ (kg)'
                            },
                            grid: {
                                drawOnChartArea: false
                            }
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
